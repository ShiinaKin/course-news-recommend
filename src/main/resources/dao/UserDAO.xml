<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.sakurasou.newsrecommend.dao.UserDAO">

  <resultMap id="UserResult" type="io.sakurasou.newsrecommend.model.User">
    <id column="id" property="id"/>
    <result column="username" property="username"/>
    <result column="password_hash" property="passwordHash"/>
    <result column="nickname" property="nickname"/>
    <result column="created_at" property="createdAt"/>
  </resultMap>

  <select id="findById" parameterType="long" resultMap="UserResult">
    SELECT id, username, password_hash, nickname, created_at
    FROM users
    WHERE id = #{id}
  </select>

  <select id="findByUsername" parameterType="string" resultMap="UserResult">
    SELECT id, username, password_hash, nickname, created_at
    FROM users
    WHERE username = #{username}
  </select>

  <insert id="insert" parameterType="io.sakurasou.newsrecommend.model.User"
          useGeneratedKeys="true" keyProperty="id">
    INSERT INTO users (username, password_hash, nickname, created_at)
    VALUES (#{username}, #{passwordHash}, #{nickname}, CURRENT_TIMESTAMP)
  </insert>

</mapper>
